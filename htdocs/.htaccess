RewriteEngine on
RewriteBase /

# Force https
RewriteCond %{SERVER_PORT} !^443$ [nc]
RewriteRule (.*) https://%{HTTP_HOST}/$1 [R=permanent,nc,L]

# Support for http-auth at fast-cgi
RewriteCond %{HTTP:Authorization} ^(.*)
RewriteRule ^(.*) - [E=HTTP_AUTHORIZATION:%1]

# Rewirte 1601-Extensions
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([a-zA-Z0-9]*)$ extension/www1601com_$1/ [L]

# Rewirte 1601-Extensions // Backward compatibility
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^([a-zA-Z0-9]*).php$ $1 [R=301,L]

# Rewirte other Extensions
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(\w*_\w*)$ extension/$1/ [L]